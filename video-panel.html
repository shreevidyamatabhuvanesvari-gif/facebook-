<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Reel Auto Caption</title>

<style>
body {
  background: black;
  margin: 0;
  text-align: center;
  color: white;
  font-family: Arial, sans-serif;
}

#videoContainer {
  position: relative;
  display: inline-block;
  margin-top: 20px;
}

video {
  width: 400px;
  max-width: 90vw;
  border-radius: 10px;
}

#caption {
  position: absolute;
  bottom: 15%;
  width: 100%;
  text-align: center;
  font-size: 35px;
  font-weight: bold;
  color: yellow;
  pointer-events: none;
}

#videoContainer:fullscreen video {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

#videoContainer:fullscreen #caption {
  font-size: 60px;
}

button {
  padding: 10px 20px;
  margin: 10px;
  font-size: 16px;
  cursor: pointer;
  border-radius: 5px;
  border: none;
}
</style>
</head>

<body>

<h2>Upload Reel Video</h2>

<input type="file" id="videoInput" accept="video/*">
<br>
<button onclick="startEverything()">Play + Auto Caption</button>
<button onclick="goFullScreen()">Full Screen</button>

<div id="videoContainer">
  <video id="videoPlayer"></video>
  <div id="caption"></div>
</div>

<script>
const videoInput = document.getElementById("videoInput");
const videoPlayer = document.getElementById("videoPlayer");
const caption = document.getElementById("caption");

let recognition;

videoInput.addEventListener("change", function() {
  const file = this.files[0];
  if (file) {
    const url = URL.createObjectURL(file);
    videoPlayer.src = url;
  }
});

function startEverything() {
  videoPlayer.play();
  startSpeechRecognition();
}

function startSpeechRecognition() {

  if (!('webkitSpeechRecognition' in window)) {
    alert("Speech Recognition not supported in this browser.");
    return;
  }

  recognition = new webkitSpeechRecognition();
  recognition.continuous = true;
  recognition.interimResults = true;
  recognition.lang = "hi-IN";

  recognition.onresult = function(event) {
    let transcript = "";

    for (let i = event.resultIndex; i < event.results.length; ++i) {
      transcript += event.results[i][0].transcript;
    }

    caption.innerHTML = `
      <span style="color:${randomColor()}">
        ${transcript}
      </span>
    `;
  };

  recognition.onerror = function(event) {
    console.log("Speech error:", event.error);
  };

  recognition.start();
}

function randomColor() {
  const colors = ["yellow", "cyan", "pink", "orange"];
  return colors[Math.floor(Math.random() * colors.length)];
}

function goFullScreen() {
  const container = document.getElementById("videoContainer");

  if (container.requestFullscreen) {
    container.requestFullscreen();
  }
}
</script>

</body>
</html>
